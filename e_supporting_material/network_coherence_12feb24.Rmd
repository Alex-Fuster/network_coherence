---
title: "Network Coherence - current state of concept"
output:
  html_document:
    df_print: paged
  html_notebook: default
  pdf_document: default
editor_options: 
  markdown: 
    wrap: 72
---


<br>

### Motivation

<br>

We currently lack theory and methods to predict community-level
responses to environmental change, and the objective of our study is to
develop a conceptual and mathematical framework to address this problem.
To do this, we introduce a metric of Network Coherence (CN), which
quantifies the degree of association between a community response to a
specific environment and its biotic interactions. NC can be a direct
indicator of the predictability of communities in front of environmental
changes, and we think it can be important in assessing how their
structure and functioning will be impacted.

<br>

### Network Coherence concept

<br>

We define Network Coherence (NC) as "the degree to which the sensitivity
and rate in response of a given community to specific environmental
variables at a given location (defined as the instantaneous rate of
change in"fitness" or abundance of each species in response to
fluctuations in abiotic conditions) is associated with its species
interactions."

The response is quantified incorporating both the sensitivity (i.e. how
much the change in response is affected by the environment) and rate
(i.e. how much time it takes to the species to develop a response), and
can be either "intrinsic" or "net": intrinsic responses refer to the
inherent qualities and behaviors that a species exhibits in response to
specific environmental variables (i.e. fitness) independently of the
effect of other species, whereas net responses correspond to the change
in abundance, which result from the combined effect of multiple factors
such as biotic interactions, in addition to the environment.

NC is also defined by the grain, frequency, and extend of the
interactions and environmental variables. For the interactions, the
grain size refers to how the information is aggregated in the network
(pairwise interactions, genus, guilds, functional groups...), and for
the environment, it corresponds to the resolution; the frequency to how
often the environment change occurs, from rapid fluctuations to
long-term trends. The choice of these scales will depend on the question
under study, and because the concept arises from the concept of
community, these are restricted to limits where interactions matter
(e.g. trees competition occurs at regional levels).

The NC metric is computed correlating the matrix of biotic interactions
$A$ with a matrix of taxa covariances with the environment $C$. We can
use a *Procrustes* analysis to assess the degree of correspondence
between the observed species interactions and the coherence of species'
responses to environmental variables.

<br>

$$ NC = Procrustes (A, C) $$


<br>

#### Environmental coherence matrix

<br>

The environmental coherence matrix ($C$) should accurately represent the
pairwise co-response of species to the environment.

<br>

*Intrinsic responses*

Because we dont have data of the fitness of multiple species across the
space, we can approximate species' sensitivity to the environment
employing SDMs. From the modelled suitability curves (or ocurrence
probability curves), we can obtain the sensitivity of species $\beta_i$
at a given spatial point $x_k$ by calculating the first derivative of
the curve $F(x_i)$.

<br>

$$\beta_i = \frac{dF(x_i)}{dx_i} \bigg|_{x=x_k}$$

$$ Cov(Iresponse_i, Iresponse_j) $$

<br>

The rate at which species respond to environmental change depends on
their generation time: shorter generation times allow species to respond
faster. Data on species' generation time is scarce, but we can
approximate it with the organismal size because they are linked: smaller
organisms show higher generation times due to having higher metabolic
rates, higher investment in reproduction, higher resource adquisition
and use, and shorter life-spans. Therefore, smaller species should
respond faster and therefore show increased sensitivity to changes in
the environment.

The intrinsic response $Iresponse$ to the environment at a given spatial
point would then be the joint effects of the magnitude and direction of
the sensitivity $\beta_i$ (slope) and the rate of response which is
inversely proportional to body size ($l_i^{-1}$):

<br>

$$ Iresponse_i = sensitivity \cdot rate = \beta_i \cdot l_i^{-1} $$

<br>

Each value of the $C$ matrix involving a pair of species would then be:

<br>

$$ C_{{ij}} = Cov (\beta_i(x_k) \cdot l_i^{-1}, \beta_j(x_k) \cdot l_j^{-1}) $$

<br>

> <small>We might compute correlations instead of covariances between
> pairs to standarize between the slope and body size units.</small>

> <small> We can consider one to multiple environmental variables
> depending on the type of question under study (e.g. what is the NC
> that insect-plant pollination communities show to
> temperature?).</small>

<br>

At regional scales, the responses (slopes) can vary across space. We can
then take into account an average of multiple covariances at multiple
points in the environmental gradient:

<br>

$$C_{{ij}} = \frac{\sum_{k = 1}^{n} Cov(P_i'(x_k) , P_j'(x_k))}{n}$$

<br>



*Net responses*

The matrix of covariance of net responses can be computed locally and
regionally from population time series. A community-level dynamic latent
trend model, which models abundance as a function of time and species as random effects, can be used to capture the joint variation between species
as their biomass fluctuates through time (Hebert et al. unpubl). Species' correlation coefficients correspond to the pairwise co-response
to the environment.

<br>



<div style="text-align:center">
    ![Image Alt Text](figues/fig1.PNG)
</div>

------------------------------------------------------------------------

### General expectations

<br>

-   Alteration in community structure and functioning with environmental change
    should be inversely proportional to coherence.

-   The coherence between interacting species should be more important
    for the system dynamics than the coherence of the whole community
    (i.e. including non-interacting pairs).
    
-   Species roles in driving community responses to environmental change will depend on their contribution to both network structure and coherence.

------------------------------------------------------------------------












::: {style="margin: 20px;"}
::: {style="background-color: #f2f2f2; padding: 10px;"}
### NC to anticipate consequences of environmental changes on ecosystem functioning

<br>

**Objective:** Derive mathematical theory that would provide an expectation
on the relationship between ecological coherence and changes in
ecosystem functioning

**Intuition:** Lack of coherence will lead to disruptions in ecosystem
functioning. Expected change in ecosystem functioning is proportional to
the inverse of ecological coherence.

---------------------

<br>

##### **Direct versus net interactions in foodwebs**

<br>

Consider the standard Lotka-Volterra model of ecological interactions:

<br>

$$\frac{dN_i}{dt} = N_i (b_i - \sum \alpha_{ij}N_j)$$ 

<br>

which has for equilibrium solution:

<br>

$$ \hat{N}  = A^{-1}b$$

<br>

where $A^{-1}$ is the inverse of the interaction matrix. By inversing
the interaction matrix, we obtain the net effects (direct and indirect)
of biotic interactions.

<br>
<br>

##### **Ecosystem functioning**

<br>

The equilibrium primary productivity is defined as the sum of influxes
coming into the foodweb through primary producers (first trophic level
$T1$):

<br>

$$\phi_1 = \sum_{i \in T1 }  b_iN_{1i}$$

<br>

And the equilibrium for secondary productivity corresponds to the total
metabolic rate of heterotrophs:

<br>

$$\phi_2 = -\sum_{i \in T2U...UTn } b_iN_{2i}$$

<br>

We know from press perturbation theory (Bender et al. 1984) that changes
in abundance of a species $i$ will occur as a result of the net
interaction coefficient of species $i$ and $j$ times the amount of
change we would expect in the $b$ coefficient:

<br>

$$ \delta N_{i} = a_{ij}^{(-1)}\delta b_j$$

<br>

where the superscript (-1) indicates elements of the inverse interaction
matrix.

The problem is: what is the expected change in density for any given
species, $E[\delta N_i]$ knowing that the $b$ coefficients are changing?

<br>
<br>

##### **Useful properties of random variables**

<br>

The expectation of a product of random variables $r_1$ and $r_2$ is:

<br>

$$ E[r_1 r_2] = E[r_1] + E[r_2] + cov(r_1, r_2) $$

<br>

The variance is more difficult to assess, but in the specific case of a
product of random centered normal distributions is:

<br>

$$ var(r_1 r_2) = 1 + p^2$$

<br>

where $p$ is the correlation coefficient.

<br>

$$ E[\delta N_{i}] = E[a_{ij}^{(-1)} + E[\delta b_j] + cov(a_{ij}^{(-1)}, \delta b_j) ] $$

<br>
<br>

##### **Anticipating consequences of environmental changes**

<br>

Coming back to the calculation of changes in abundance

<br>

$$ \delta N_{ij} = a_{ij}^{(-1)}\delta b_j$$

<br>

we get:

<br>

$$ E[\delta N_{ij}] = E[a_{ij}^{(-1)} + E[\delta b_j] + cov(a_{ij}^{(-1)}, \delta b_j) ] $$

<br>




##### **Expectations**

<br>

-   Change in abundance will increase with the correlation between net
    interaction strength and the magnitude of the environmental impact.
    This supports the intuition that changes in the environment will be
    more disrupting if they happen for strong interactions than if it
    happens for weak interactions; or, for a given net interaction
    strength, we expect stronger changes in abundances if the
    environment changes are stronger.

-   The variance in the pairwise effects will increase with the square
    of the correlation. Or at least, it should increase non-linearly.
    

<br>
<br>


##### **Useful properties of random variables**

<br>

The expectation of a sum of random variables r_1 and r_2 is:

<br>

$$ E[r_1 + r_2] = E[r_1] + E[r_2] $$

<br>

The variance is:

<br>

$$var(r1 + r2) = var(r_1) + var(r_2) + 2cov(r_1, r_2)  $$

<br>
<br>


##### **Anticipating consequences of environmental changes**

<br>

turning to exosystem functioning:

<br>

$$ E[\delta \phi^1] = \sum E[ \delta \phi_i^1] $$

<br>

we get:

<br>

$$ var(\delta \phi^1) = \sum  \delta \phi_i^1 + 2 \sum cov(\delta \phi_i^1, \delta \phi_j^1)$$

<br>

----------------------


##### **Expectations**

<br>

-   The expected ecosystem functioning should not be impacted by
    coherence.

-   The variance in ecosystem functioning will be inversely proportional
    to coherence.
    
----------------------

> <small>!This is counterintuitive to us and the formulas need to be
> revisited.</small>
:::
:::




<br> <br> <br>

::: {style="background-color: #f2f2f2; padding: 10px;"}
### NC and network beta diversity

<br>

We currently don't have a solid mechanistic understanding on the drivers
of network turnover.

**Objective:** mathematically link coherence to network beta diversity

___________

<br>

The probability of observing an interaction between a pair of species in
a given environment depends on the probability that species co-occur and
thay they interact:

<br>

$$ P(L_{ij}, x_i, x_j | E) = P(L_{ij}|E) P(x_i,x_j | E) $$

<br>

The probability of species co-occurring $P(x_i,x_j | E)$ can be
decomposed further down into a condition probability: 

<br>

$$  P(x_i,x_j | E) = P(x_i | x_j, E) P (x_j | E) $$
<br>

where the first term at the right side of the equation is the probability of
observing one species given the presence of the other in a given
environment and the second is the probability of observing the other species.

The first term $P(x_i| x_j, E)$ is actually a measure of correlation between
the two species, and therefore directly related to coherence.

We would then expect different beta diversity depending on the coherence in species responses and the structure of the L matrix.


<br>

**Expectations**

-   NC shoud decrease with modularity and increase with nestedness
    [CONNECTANCE, DEGREE DISTRIBUTION]

-   Niche breath - low and high extremes would decrease coherence, but
    moderate values would increase it.

-   contribution to bs and Bos

> <small>The relationship between coherence and beta diversity is
> contingent on how we measure beta diversity on networks - at the
> macro-level, there is no still convincing method to compare the
> structure of networks (i.e. compare species' roles rather than nodes
> and links).</small>

-   Mutualists would show higher coherence than antagonists

-   Competition interactions would show higher incoherence than
    predator-prey.
:::

<br> <br> <br>

::: {style="background-color: #f2f2f2; padding: 10px;"}
### NC to identify kestonne species for the response of communities to environmental change

<br>

**Objective:** Derive mathematical theory that would provide an expectation
on species' roles in the stability of communities in the face of
environmental changes.

-------------

To explore this question, we can analyze the impact of species' removal
on NC.

<br>

**Expectations**

-   Species with lower coherence and more central in the network will be
    responsible of the highest amount of disruptions occurring in the
    network in response to environmental change.

-   The contribution of species to NC should depend on the size and
    generalism level of the network. This is because increasing size and
    generalism increases the redundancy on both network roles and
    coherence of species, which makes perturbations more diffused. In
    smaller networks and specialist interactions, the consequences of
    species' removals would have higher consequences because there would
    be more direct effects involved.

> <small>It would also be interesting to investigate the correlation
> between species' contributions to network structure and to
> coherence.</small>

[...]
:::



Other expectations:


-   Communities in more seasonal environments may show higher Network
    Coherence because species may be more synchronized in responding to
    predictable changes in the environment.

-   NC may decrease with the aggregation of network-level information
    (taxonomic, guilds, functional groups)
    
    

Other considerations:
    
    
-   We should also take into account the fact that some environmental changes are more predictable (e.g. increase in temperature) than others (e.g. drought events).


$$ C_{i,j} = corr(\alpha_i, \alpha_j)$$